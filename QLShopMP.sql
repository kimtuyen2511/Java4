CREATE DATABASE QLSHOPMYPHAM
USE QLSHOPMYPHAM
GO
/*
CREATE TABLE KHO(
MaKho INT PRIMARY KEY IDENTITY (1,1) NOT NULL,
SoLuong INT,
);
*/
GO

CREATE TABLE LOAISP(
MaLoai INT IDENTITY(1,1) PRIMARY KEY,
TenLoai NVARCHAR (100)
);

GO
CREATE TABLE SANPHAM(
MaSP INT PRIMARY KEY IDENTITY (1,1) NOT NULL,
TenSP NVARCHAR(255),
GiaBan FLOAT,
ThuongHieu NVARCHAR(50),
CongDung NVARCHAR(255),
ThanhPhan NVARCHAR(255),
HSD NVARCHAR(200),
Hinh NVARCHAR(255),
SoLuong INT,
MaLoai INT
FOREIGN KEY (MaLoai) REFERENCES LOAISP(MaLoai) ON DELETE NO ACTION ON UPDATE CASCADE
);

GO
CREATE TABLE NHANVIEN(
MaNV INT PRIMARY KEY IDENTITY (1,1),
TenNV NVARCHAR(255),
GioiTinh bit,
NgaySinh DATE,
DiaChi NVARCHAR(255),
SDT NVARCHAR (11),
CCCD NVARCHAR(12),
Email NVARCHAR(255),
HinhAnh NVARCHAR(MAX) 
);

GO
CREATE TABLE ACCOUNT(
MaAccount INT IDENTITY (1,1) PRIMARY KEY,
UserName NVARCHAR(255),
Pass NVARCHAR(30),
ChucVu NVARCHAR(500),
MaNV INT
FOREIGN KEY (MaNV) REFERENCES NHANVIEN(MaNV)
);


GO
CREATE TABLE KHACHHANG(
MaKH INT PRIMARY KEY IDENTITY (1,1),
TenKH NVARCHAR(255),
GioiTinh NVARCHAR (3),
NgaySinh DATE,
DiaChi NVARCHAR(255),
SDT NVARCHAR (11),
EMAIL NVARCHAR(255)
);

GO
CREATE TABLE DONHANG (
MaDH INT IDENTITY (1,1) PRIMARY KEY,
NgayTao DATE,
NguoiTao NVARCHAR(255),
TongTien FLOAT,
Sale FLOAT,
ThanhTien FLOAT,
TrangThai bit,
IDAccount INT,
MaKH INT,
FOREIGN KEY (IDAccount) REFERENCES ACCOUNT(MaAccount),
FOREIGN KEY (MaKH) REFERENCES KHACHHANG(MaKH) ON DELETE NO ACTION ON UPDATE CASCADE
);

GO

GO
CREATE TABLE CTDH (
MaCTDH INT IDENTITY (1,1) PRIMARY KEY,
SL INT,
MaDH INT,
MaSP INT
FOREIGN KEY (MaDH) REFERENCES DONHANG(MaDH),
FOREIGN KEY (MaSP) REFERENCES SANPHAM(MaSP)
);

GO
CREATE TABLE HOADON (
MaHD INT UNIQUE,
NgayTao DATE,
NguoiTao NVARCHAR(255),
TongTien FLOAT,
Sale FLOAT,
ThanhTien FLOAT,
MaKH INT
FOREIGN KEY (MaHD) REFERENCES DONHANG(MaDH)
);


GO
CREATE TABLE PHIEUNHAP(
MaPN INT IDENTITY (1,1) PRIMARY KEY,
NgayTao DATE,
NguoiTao NVARCHAR(255),
ThanhTien FLOAT,
MaAccount INT NULL
FOREIGN KEY (MaAccount) REFERENCES ACCOUNT(MaAccount)
);

GO
CREATE TABLE CTPN (
MaCTPN INT IDENTITY (1,1) PRIMARY KEY,
SL INT,
GiaNhap FLOAT,
MaPN INT,
MaSP INT,
NSX date
FOREIGN KEY (MaPN) REFERENCES PHIEUNHAP(MaPN),
FOREIGN KEY (MaSP) REFERENCES SANPHAM(MaSP)
);
GO


--INSERT DỮ LIỆU
--LOẠI SẢN PHẨM
SELECT * FROM LOAISP
INSERT INTO LOAISP
VALUES
(N'Trang điểm'),
(N'Chăm sóc da'),
(N'Nước hoa')

DELETE LOAISP
--SẢN PHẨM
SELECT * FROM SANPHAM
INSERT INTO SANPHAM
VALUES	
--lIST TRANG ĐIỂM
(N'SON ROUGE PUR COUTURE THE SLIM 2',1200000,N'YSL',N'dưỡng ẩm, trị thâm, làm sáng đều màu môi.',N'tinh dầu jojoba, tinh dầu Macadamia bơ và nhiều loại vitamin.  Son không chì dưỡng môi tốt, hợp với da nhạy cảm.',N'2 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',1,1),
(N'SON MÔI ROUGE PUR COUTURE THE SLIM VELVET RADICAL',1200000,N'YSL',N'dưỡng ẩm, trị thâm, làm sáng đều màu môi.',N'tinh dầu jojoba, tinh dầu Macadamia bơ và nhiều loại vitamin.  Son không chì dưỡng môi tốt, hợp với da nhạy cảm.',N'2 năm kể từ ngày sản xuất',N'SON MÔI ROUGE PUR COUTURE THE SLIM VELVET RADICAL.jpg',2,1),
(N'SON KEM LÌ TATOUAGE COUTURE VELVET CREAM',1200000,N'YSL',N'dưỡng ẩm, trị thâm, làm sáng đều màu môi.',N'tinh dầu jojoba, tinh dầu Macadamia bơ và nhiều loại vitamin.  Son không chì dưỡng môi tốt, hợp với da nhạy cảm.',N'2 năm kể từ ngày sản xuất',N'SON KEM LÌ TATOUAGE COUTURE VELVET CREAM.jpg',3,1),
(N'SON THỎI SATIN LÌ THE BOLD',1200000,N'YSL',N'dưỡng ẩm, trị thâm, làm sáng đều màu môi.',N'tinh dầu jojoba, tinh dầu Macadamia bơ và nhiều loại vitamin.  Son không chì dưỡng môi tốt, hợp với da nhạy cảm.',N'2 năm kể từ ngày sản xuất',N'SON THỎI SATIN LÌ THE BOLD.jpg',4,1),
(N'BẢNG MẮT COUTURE COLOR CLUTCH',3800000,N'YSL',N'Làm đẹp',NULL,N'2 năm kể từ ngày sản xuất',N'BẢNG MẮT COUTURE COLOR CLUTCH.jpg',5,1),
(N'CUSHION EDP LAMÉ COLLECTOR',1960000,N'YSL',N'Làm đẹp',NULL,N'2 năm kể từ ngày sản xuất',N'CUSHION EDP LAMÉ COLLECTOR.jpg',6,1),
(N'MASCARA MVEFC WATERPROOF',1400000,N'YSL',N'Làm đẹp',NULL,N'2 năm kể từ ngày sản xuất',N'MASCARA MVEFC WATERPROOF.jpg',7,1),
(N'PHẤN PHỦ SOUFFLE DECLAT',1900000,N'YSL',N'Làm đẹp',NULL,N'2 năm kể từ ngày sản xuất',N'PHẤN PHỦ SOUFFLE DECLAT.jpg',8,1),
-- LIST CHĂM DA
(N'KEM CHỐNG NẮNG PURE SHOTS AIRTHIN UV DEFENDER',1200000,N'YSL',N'chống các UV, SPS 50+.',NULL,N'2 năm kể từ ngày sản xuất',N'KEM CHỐNG NẮNG PURE SHOTS AIRTHIN UV DEFENDER.jpg',1,2),
(N'KEM DƯỠNG ẨM PURE SHOTS PERFECT PLUMPER',1200000,N'YSL',N'dưỡng ẩm, trị thâm, làm sáng đều màu da.',NULL,N'2 năm kể từ ngày sản xuất',N'KEM DƯỠNG ẨM PURE SHOTS PERFECT PLUMPER.jpg',2,2),
(N'PURE SHOTS LINES AWAY SERUM',1200000,N'YSL',N'tinh chất phục hồi da, cấp ẩm, đều màu da.',NULL,N'2 năm kể từ ngày sản xuất',N'PURE SHOTS LINES AWAY SERUM.jpg',3,2),
(N'Tinh chất chống lão hóa, tái tạo da The Ordinary “Buffet”',1200000,N'Ordinary',N'dưỡng ẩm, chống lão hóa, tái tạo da',NULL,N'2 năm kể từ ngày sản xuất',N'Tinh chất chống lão hóa, tái tạo da The Ordinary “Buffet”.jpg',4,2),
(N'Tinh chất trị mụn The Ordinary Salicylic Acid 2% Solution (BHA)',1200000,N'Ordinary',NULL,NULL,N'2 năm kể từ ngày sản xuất',N'Tinh chất trị mụn The Ordinary Salicylic Acid 2% Solution (BHA).jpg',5,2),
(N'Kem dưỡng ẩm The Ordinary',1200000,N'Ordinary',NULL,NULL,N'2 năm kể từ ngày sản xuất',N'Kem dưỡng ẩm The Ordinary Natural Moisturizing Factor + HA.jpg',6,2),
(N'Serum dưỡng tóc The Ordinary',1200000,N'Ordinary',NULL,NULL,N'2 năm kể từ ngày sản xuất',N'Serum dưỡng tóc The Ordinary.jpg',7,2),
(N'Tinh chất tẩy tế bào chết & cấp nước The Ordinary',1200000,N'Ordinary',NULL,NULL,N'2 năm kể từ ngày sản xuất',N'Tinh chất tẩy tế bào chết & cấp nước The Ordinary.jpg',8,2),
--LIST NƯỚC HOA
(N'TÊN NƯỚC HOA1',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',1,3),
(N'TÊN NƯỚC HOA2',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',2,3),
(N'TÊN NƯỚC HOA3',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',3,3),
(N'TÊN NƯỚC HOA4',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',4,3),
(N'TÊN NƯỚC HOA5',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',5,3),
(N'TÊN NƯỚC HOA6',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',6,3),
(N'TÊN NƯỚC HOA7',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',7,3),
(N'TÊN NƯỚC HOA8',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',8,3),
(N'TÊN NƯỚC HOA9',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',9,3),
(N'TÊN NƯỚC HOA10',200000,N'YSL',N'Tạo mùi hương lôi cuốn',NULL,N'3 năm kể từ ngày sản xuất',N'SON ROUGE PUR COUTURE THE SLIM 2.jpg',10,3)


--KHÁCH HÀNG
SELECT * FROM KHACHHANG
INSERT INTO KHACHHANG
VALUES
(N'Phạm Trí Phúc',N'1','2004-11-25',N'Cà Mau',0791234212,N'phucptpc05587@fpt.edu.vn'),
(N'Dương Văn Kha',N'1','2004-05-28',N'Hậu Giang',0791234211,N'khadv05684@fpt.edu.vn'),
(N'Phạm Minh Đức',N'1','2004-11-25',N'Cà Mau',0791234213,N'ducpmpc05567@fpt.edu.vn'),
(N'Trần Ngọc Anh Thư',N'0','2004-11-25',N'Cà Mau',0791234214,N'thutnapc05583@fpt.edu.vn'),
(N'Hồ Thị Trúc Ly',N'0','2004-11-25',N'Cà Mau',0791234216,N'lyhttpc05588@fpt.edu.vn'),
(N'Hồ Trúc Ly',N'0','2004-11-25',N'Cà Mau',0791234215,N'lytpc05587@fpt.edu.vn'),
(N'Phan Văn Khánh',N'1','2004-11-25',N'Cà Mau',0791234217,N'khanhpvpc04226@fpt.edu.vn'),
(N'Đặng Vĩnh Kỳ',N'1','2004-11-25',N'Cà Mau',0791234218,N'kydvpc05475@fpt.edu.vn'),
(N'Nguyễn Vũ Đầy',N'1','2004-11-25',N'Cà Mau',0791234219,N'daynvpc05484@fpt.edu.vn'),
(N'Võ Nhựt Duy',N'1','2004-11-25',N'Cà Mau',0791234222,N'duyvnpc05487@fpt.edu.vn'),
(N'Lê Tuấn Kiệt',N'1','2004-11-25',N'Cà Mau',0791234232,N'kietltpc05503@fpt.edu.vn'),
(N'Đinh Văn Phát',N'1','2004-11-25',N'Cà Mau',0791234242,N'phatdvpc05504@fpt.edu.vn'),
(N'Trần Văn Nghĩa',N'1','2004-11-25',N'Cà Mau',0791234252,N'nghiatvpc05510@fpt.edu.vn'),
(N'Trần Tô Phước Triều',N'1','2004-11-25',N'Cà Mau',0791234262,N'trieuttppc05514@fpt.edu.vn'),
(N'Nguyễn Minh Triệu',N'1','2004-11-25',N'Cà Mau',0791234272,N'trieunmpc05519@fpt.edu.vn'),
(N'Trần Nguyễn Đông Duy',N'1','2004-11-25',N'Cà Mau',0791234282,N'duytndpc05535@fpt.edu.vn'),
(N'Tống Bình Phú',N'1','2004-11-25',N'Cà Mau',0791234292,N'phutbpc05547@fpt.edu.vn'),
(N'Nguyễn Tuấn Khôi',N'1','2004-11-25',N'Cà Mau',0791235212,N'khointpc05548@fpt.edu.vn'),
(N'Nguyễn Minh Khanh',N'1','2004-11-25',N'Cà Mau',0791236212,N'khanhnmpc05586@fpt.edu.vn'),
(N'Thạch Hoài An',N'1','2004-11-25',N'Cà Mau',0791237212,N'anthpc05573@fpt.edu.vn')


--NHÂN VIÊN
SELECT * FROM NHANVIEN
INSERT INTO NHANVIEN
VALUES
(N'Nguyễn Thanh Hiếu',0,'2003-08-11',N'Cà Mau',N'0797932451',N'092132123123',N'thanhhieu@gmail.com',NULL),
(N'Nguyễn Minh Tâm',0,'2003-08-11',N'Cà Mau',N'0797932452',N'092132123124',N'minhtam@gmail.com',NULL),
(N'Nguyễn Trần Lượng',0,'2003-08-11',N'Cà Mau',N'0797932453',N'092132123125',N'tranluong@gmail.com',NULL),
(N'Nguyễn Khánh Tâm',0,'2003-08-11',N'Cà Mau',N'0797932454',N'092132123126',N'khanhtam@gmail.com',NULL),
(N'Nguyễn Tuấn Huy',0,'2003-08-11',N'Cà Mau',N'0797932455',N'092132123127',N'tuanhuy@gmail.com',NULL)
-- Nhân viên chưa có ACCOunt

INSERT INTO NHANVIEN
VALUES
(N'Nguyễn Văn An',0,'2003-08-11',N'Cà Mau',N'0797932451',N'092132123123',N'an@gmail.com',NULL),
(N'Nguyễn Thị Bình',1,'2003-08-11',N'Cà Mau',N'0797932452',N'092132123124',N'binh@gmail.com',NULL),
(N'Nguyễn Trần Tâm Như',1,'2003-08-11',N'Cà Mau',N'0797932453',N'092132123125',N'nhu@gmail.com',NULL),
(N'Nguyễn Khánh My',1,'2003-08-11',N'Cà Mau',N'0797932454',N'092132123126',N'my@gmail.com',NULL),
(N'Nguyễn My Trang',1,'2003-08-11',N'Cà Mau',N'0797932455',N'092132123127',N'trang@gmail.com',NULL)

SELECT * FROM NHANVIEN A JOIN ACCOUNT B ON A.MaNV=B.MaAccount 

--ACCOUNT
SELECT * FROM ACCOUNT
INSERT INTO ACCOUNT
VALUES
(N'ThanhHieu',N'thanhhieu123','Nhân Viên',1),
(N'Minhtam',N'minhtam123','Nhân Viên',2),
(N'TranLuong',N'tranluong123','Nhân Viên',3),
(N'KhanhTam',N'khanhtam123','Nhân Viên',4),
(N'TuanHuy',N'tuanhuy123','Nhân Viên',5)

--ĐƠN HÀNG
SELECT * FROM DONHANG
INSERT INTO DONHANG
VALUES
('2023-10-08',N'ThanhHieu',5700000,0.02,5586000,0,1,4),
('2023-10-09',N'TranLuong',5700000,0.02,5586000,0,3,1),
('2023-10-10',N'TranLuong',5700000,0.02,5586000,0,3,2),
('2023-10-11',N'ThanhHieu',5700000,0.02,5586000,0,1,3),
('2023-10-12',N'TuanHuy',5700000,0.02,5586000,0,5,5),
('2023-10-13',N'TuanHuy',5700000,0.02,5586000,0,5,4)
-- PHIẾU NHẬP

--CHI TIẾT ĐƠN HÀNG
SELECT * FROM CTDH
INSERT INTO CTDH
VALUES
(1,1,1),
(1,1,3),
(1,1,6),
(1,1,7),
(1,2,1),
(1,2,3),
(1,2,6),
(1,2,7),
(1,3,1),
(1,3,3),
(1,3,6),
(1,3,7),
(1,4,1),
(1,4,3),
(1,4,6),
(1,4,7),
(1,5,1),
(1,5,3),
(1,5,6),
(1,5,7),
(1,6,1),
(1,6,3),
(1,6,6),
(1,6,7)

SELECT B.MaSP,A.TenSP,B.SL,A.GiaBan FROM SANPHAM A JOIN CTDH B ON A.MaSP=B.MaSP WHERE MaDH=2
-- mua hàng 
-- Thêm
--viết trc hết là insert vào bảng ĐƠN HÀNG, sau đó truy xuất đến mã đơn hàng vừa thêm, r insert (SL,MaxDH,MaSP) vào CTDH
-- Xóa
-- xóa ctdh, r xóa đơn hàng

-- HÓA ĐƠN
SELECT * FROM HOADON
INSERT INTO HOADON
VALUES
(1,'2023-10-08',N'ThanhHieu',5700000,0.02,5586000,4),
(2,'2023-10-09',N'TranLuong',5700000,0.02,5586000,1),
(3,'2023-10-10',N'TranLuong',5700000,0.02,5586000,2),
(4,'2023-10-11',N'ThanhHieu',5700000,0.02,5586000,3),
(5,'2023-10-12',N'TuanHuy',5700000,0.02,5586000,5),
(6,'2023-10-13',N'TuanHuy',5700000,0.02,5586000,4)
-- PHIẾU NHẬP
SELECT * FROM PHIEUNHAP
INSERT INTO PHIEUNHAP
VALUES
('2023-10-08',N'ThanhHieu',5586000,1),
('2023-11-08',N'TranLuong',5586000,3),
('2023-12-08',N'TranLuong',5586000,3),
('2023-1-08',N'Minhtam',5586000,2),
('2023-2-08',N'TuanHuy',5586000,5),
('2023-3-08',N'TuanHuy',5586000,5),
('2023-4-08',N'ThanhHieu',5586000,1),
('2023-5-08',N'KhanhTam',5586000,4),
('2023-6-08',N'KhanhTam',5586000,4),
('2023-8-08',N'Minhtam',5586000,2)

--CHI TIẾT PHIẾU NHẬP
SELECT * FROM CTPN
INSERT INTO CTPN
VALUES
(1,1100000,1,1,GETDATE()),
(1,1100000,1,3,GETDATE()),
(1,1800000,1,6,GETDATE()),
(1,1300000,1,7,GETDATE()),
(1,1100000,2,1,GETDATE()),
(1,1100000,2,3,GETDATE()),
(1,1800000,2,6,GETDATE()),
(1,1300000,2,7,GETDATE()),
(1,1100000,3,1,GETDATE()),
(1,1100000,3,3,GETDATE()),
(1,1800000,3,6,GETDATE()),
(1,1300000,3,7,GETDATE()),
(1,1100000,4,1,GETDATE()),
(1,1100000,4,3,GETDATE()),
(1,1800000,4,6,GETDATE()),
(1,1300000,4,7,GETDATE()),
(1,1100000,5,1,GETDATE()),
(1,1100000,5,3,GETDATE()),
(1,1800000,5,6,GETDATE()),
(1,1300000,5,7,GETDATE()),
(1,1100000,6,1,GETDATE()),
(1,1100000,6,3,GETDATE()),
(1,1800000,6,6,GETDATE()),
(1,1300000,6,7,GETDATE()),
(1,1100000,7,1,GETDATE()),
(1,1100000,7,3,GETDATE()),
(1,1800000,7,6,GETDATE()),
(1,1300000,7,7,GETDATE()),
(1,1100000,8,1,GETDATE()),
(1,1100000,8,3,GETDATE()),
(1,1800000,8,6,GETDATE()),
(1,1300000,8,7,GETDATE()),
(1,1100000,9,1,GETDATE()),
(1,1100000,9,3,GETDATE()),
(1,1800000,9,6,GETDATE()),
(1,1300000,9,7,GETDATE()),
(1,1100000,10,1,GETDATE()),
(1,1100000,10,3,GETDATE()),
(1,1800000,10,6,GETDATE()),
(1,1300000,10,7,GETDATE())

SELECT A.MaSP,B.TenSP,A.SL,A.GiaNhap,A.MaPN FROM CTPN A JOIN SANPHAM B ON A.MaSP=B.MaSP
ORDER BY A.MaPN

SELECT * FROM DONHANG
SELECT * FROM KHACHHANG
SELECT * FROM CTDH
-- insert thêm dô thôi k cần cũng được
INSERT INTO DONHANG
VALUES
(GETDATE(),'KhanhTam',24000000,0,24000000,0,4,10),
(GETDATE(),'TuanHuy',24000000,0,24000000,0,5,11),
(GETDATE(),'TranLuong',24000000,0,24000000,0,3,11),
(GETDATE(),'KhanhTam',24000000,0,24000000,0,4,12),
(GETDATE(),'TuanHuy',24000000,0,24000000,0,5,13),
(GETDATE(),'KhanhTam',24000000,0,24000000,0,4,14),
(GETDATE(),'TuanHuy',24000000,0,24000000,0,5,15),
(GETDATE(),'TranLuong',24000000,0,24000000,0,3,16),
(GETDATE(),'KhanhTam',24000000,0,24000000,0,4,17),
(GETDATE(),'TuanHuy',24000000,0,24000000,0,5,18)

SELECT * FROM HOADON
INSERT INTO DONHANG
VALUES
--THÁNG 1
('2022-01-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-01-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-01-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-01-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-01-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-01-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-01-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-01-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-01-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-01-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-01-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-01-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-01-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-01-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-01-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-01-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-01-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-01-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-01-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-01-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 2
('2022-02-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-02-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-02-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-02-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-02-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-02-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-02-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-02-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-02-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-02-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-02-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-02-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-02-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-02-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-02-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-02-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-02-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-02-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-02-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-02-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 3
('2022-03-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-03-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-03-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-03-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-03-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-03-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-03-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-03-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-03-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-03-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-03-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-03-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-03-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-03-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-03-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-03-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-03-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-03-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-03-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-03-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 4
('2022-04-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-04-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-04-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-04-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-04-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-04-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-04-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-04-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-04-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-04-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-04-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-04-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-04-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-04-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-04-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-04-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-04-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-04-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-04-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-04-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 5
('2022-05-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-05-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-05-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-05-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-05-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-05-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-05-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-05-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-05-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-05-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-05-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-05-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-05-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-05-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-05-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-05-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-05-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-05-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-05-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-05-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 6
('2022-06-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-06-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-06-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-06-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-06-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-06-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-06-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-06-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-06-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-06-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-06-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-06-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-06-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-06-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-06-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-06-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-06-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-06-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-06-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-06-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 7
('2022-07-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-07-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-07-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-07-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-07-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-07-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-07-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-07-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-07-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-07-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-07-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-07-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-07-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-07-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-07-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-07-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-07-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-07-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-07-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-07-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 8
('2022-08-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-08-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-08-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-08-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-08-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-08-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-08-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-08-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-08-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-08-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-08-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-08-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-08-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-08-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-08-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-08-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-08-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-08-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-08-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-08-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 9
('2022-09-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-09-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-09-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-09-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-09-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-09-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-09-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-09-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-09-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-09-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-09-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-09-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-09-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-09-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-09-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-09-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-09-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-09-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-09-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-09-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 10
('2022-10-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-10-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-10-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-10-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-10-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-10-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-10-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-10-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-10-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-10-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-10-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-10-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-10-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-10-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-10-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-10-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-10-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-10-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-10-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-10-20','TuanHuy',24000000,0,24000000,0,5,18),

('2022-10-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-10-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-10-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-10-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-10-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-10-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-10-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-10-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-10-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-10-20','TuanHuy',24000000,0,24000000,0,5,18),
('2022-09-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 11
('2022-11-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-11-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-11-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-11-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-11-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-11-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-11-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-11-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-11-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-11-10','TuanHuy',24000000,0,24000000,0,5,18),

('2022-11-11','KhanhTam',24000000,0,24000000,0,4,10),
('2022-11-12','TuanHuy',24000000,0,24000000,0,5,11),
('2022-11-13','TranLuong',24000000,0,24000000,0,3,11),
('2022-11-14','KhanhTam',24000000,0,24000000,0,4,12),
('2022-11-15','TuanHuy',24000000,0,24000000,0,5,13),
('2022-11-16','KhanhTam',24000000,0,24000000,0,4,14),
('2022-11-17','TuanHuy',24000000,0,24000000,0,5,15),
('2022-11-18','TranLuong',24000000,0,24000000,0,3,16),
('2022-11-19','KhanhTam',24000000,0,24000000,0,4,17),
('2022-11-20','TuanHuy',24000000,0,24000000,0,5,18),
--THÁNG 12
('2022-12-01','KhanhTam',24000000,0,24000000,0,4,10),
('2022-12-02','TuanHuy',24000000,0,24000000,0,5,11),
('2022-12-03','TranLuong',24000000,0,24000000,0,3,11),
('2022-12-04','KhanhTam',24000000,0,24000000,0,4,12),
('2022-12-05','TuanHuy',24000000,0,24000000,0,5,13),
('2022-12-06','KhanhTam',24000000,0,24000000,0,4,14),
('2022-12-07','TuanHuy',24000000,0,24000000,0,5,15),
('2022-12-08','TranLuong',24000000,0,24000000,0,3,16),
('2022-12-09','KhanhTam',24000000,0,24000000,0,4,17),
('2022-12-10','TuanHuy',24000000,0,24000000,0,5,18)

INSERT INTO HOADON
VALUES (7,'2023-10-10','KhanhTam',24000000,0,24000000,10),
(8,'2023-10-10','TuanHuy',24000000,0,24000000,11),
(9,'2023-10-10','TranLuong',24000000,0,24000000,11),
(10,'2023-10-10','KhanhTam',24000000,0,24000000,12),
(11,'2023-10-10','TuanHuy',24000000,0,24000000,13),
(12,'2023-10-10','KhanhTam',24000000,0,24000000,14),
(13,'2023-10-10','TuanHuy',24000000,0,24000000,15),
(14,'2023-10-10','TranLuong',24000000,0,24000000,16),
(15,'2023-10-10','KhanhTam',24000000,0,24000000,17),
(16,'2023-10-10','TuanHuy',24000000,0,24000000,18)

INSERT INTO HOADON(MaHD,NgayTao, NguoiTao, TongTien, Sale, ThanhTien, MaKH) 
VALUES
--THÁNG 1
--(17,'2022-01-01','KhanhTam',24000000,0,24000000,10),
(18,'2022-01-02','TuanHuy',24000000,0,24000000,11),
(19,'2022-01-03','TranLuong',24000000,0,24000000,11),
(20,'2022-01-04','KhanhTam',24000000,0,24000000,12),
(21,'2022-01-04','TuanHuy',24000000,0,24000000,13),
(22,'2022-01-05','KhanhTam',24000000,0,24000000,14),
(23,'2022-01-06','TuanHuy',24000000,0,24000000,15),
(24,'2022-01-07','TranLuong',24000000,0,24000000,16),
(25,'2022-01-08','KhanhTam',24000000,0,24000000,17),
(26,'2022-01-10','TuanHuy',24000000,0,24000000,18),

(27,'2022-01-11','KhanhTam',24000000,0,24000000,10),
(28,'2022-01-12','TuanHuy',24000000,0,24000000,11),
(29,'2022-01-13','TranLuong',24000000,0,24000000,11),
(30,'2022-01-14','KhanhTam',24000000,0,24000000,12),
(31,'2022-01-15','TuanHuy',24000000,0,24000000,13),
(32,'2022-01-16','KhanhTam',24000000,0,24000000,14),
(33,'2022-01-17','TuanHuy',24000000,0,24000000,15),
(34,'2022-01-18','TranLuong',24000000,0,24000000,16),
(35,'2022-01-19','KhanhTam',24000000,0,24000000,17),
(36,'2022-01-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 2
(37,'2022-02-01','KhanhTam',24000000,0,24000000,10),
(38,'2022-02-02','TuanHuy',24000000,0,24000000,11),
(39,'2022-02-03','TranLuong',24000000,0,24000000,11),
(40,'2022-02-04','KhanhTam',24000000,0,24000000,12),
(41,'2022-02-04','TuanHuy',24000000,0,24000000,13),
(42,'2022-02-05','KhanhTam',24000000,0,24000000,14),
(43,'2022-02-06','TuanHuy',24000000,0,24000000,15),
(44,'2022-02-07','TranLuong',24000000,0,24000000,16),
(45,'2022-02-08','KhanhTam',24000000,0,24000000,17),
(46,'2022-02-10','TuanHuy',24000000,0,24000000,18),

(47,'2022-02-11','KhanhTam',24000000,0,24000000,10),
(48,'2022-02-12','TuanHuy',24000000,0,24000000,11),
(49,'2022-02-13','TranLuong',24000000,0,24000000,11),
(50,'2022-02-14','KhanhTam',24000000,0,24000000,12),
(51,'2022-02-15','TuanHuy',24000000,0,24000000,13),
(52,'2022-02-16','KhanhTam',24000000,0,24000000,14),
(53,'2022-02-17','TuanHuy',24000000,0,24000000,15),
(54,'2022-02-18','TranLuong',24000000,0,24000000,16),
(55,'2022-02-19','KhanhTam',24000000,0,24000000,17),
(56,'2022-02-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 3
(57,'2022-03-01','KhanhTam',24000000,0,24000000,10),
(58,'2022-03-02','TuanHuy',24000000,0,24000000,11),
(59,'2022-03-03','TranLuong',24000000,0,24000000,11),
(60,'2022-03-04','KhanhTam',24000000,0,24000000,12),
(61,'2022-03-04','TuanHuy',24000000,0,24000000,13),
(62,'2022-03-05','KhanhTam',24000000,0,24000000,14),
(63,'2022-03-06','TuanHuy',24000000,0,24000000,15),
(64,'2022-03-07','TranLuong',24000000,0,24000000,16),
(65,'2022-03-08','KhanhTam',24000000,0,24000000,17),
(66,'2022-03-10','TuanHuy',24000000,0,24000000,18),

(67,'2022-03-11','KhanhTam',24000000,0,24000000,10),
(68,'2022-03-12','TuanHuy',24000000,0,24000000,11),
(69,'2022-03-13','TranLuong',24000000,0,24000000,11),
(70,'2022-03-14','KhanhTam',24000000,0,24000000,12),
(71,'2022-03-15','TuanHuy',24000000,0,24000000,13),
(72,'2022-03-16','KhanhTam',24000000,0,24000000,14),
(73,'2022-03-17','TuanHuy',24000000,0,24000000,15),
(74,'2022-03-18','TranLuong',24000000,0,24000000,16),
(75,'2022-03-19','KhanhTam',24000000,0,24000000,17),
(76,'2022-03-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 4
(77,'2022-04-01','KhanhTam',24000000,0,24000000,10),
(78,'2022-04-02','TuanHuy',24000000,0,24000000,11),
(79,'2022-04-03','TranLuong',24000000,0,24000000,11),
(80,'2022-04-04','KhanhTam',24000000,0,24000000,12),
(81,'2022-04-04','TuanHuy',24000000,0,24000000,13),
(82,'2022-04-05','KhanhTam',24000000,0,24000000,14),
(83,'2022-04-06','TuanHuy',24000000,0,24000000,15),
(84,'2022-04-07','TranLuong',24000000,0,24000000,16),
(85,'2022-04-08','KhanhTam',24000000,0,24000000,17),
(86,'2022-04-10','TuanHuy',24000000,0,24000000,18),

(87,'2022-04-11','KhanhTam',24000000,0,24000000,10),
(88,'2022-04-12','TuanHuy',24000000,0,24000000,11),
(89,'2022-04-13','TranLuong',24000000,0,24000000,11),
(90,'2022-04-14','KhanhTam',24000000,0,24000000,12),
(91,'2022-04-15','TuanHuy',24000000,0,24000000,13),
(92,'2022-04-16','KhanhTam',24000000,0,24000000,14),
(93,'2022-04-17','TuanHuy',24000000,0,24000000,15),
(94,'2022-04-18','TranLuong',24000000,0,24000000,16),
(95,'2022-04-19','KhanhTam',24000000,0,24000000,17),
(96,'2022-04-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 5
(97,'2022-05-01','KhanhTam',24000000,0,24000000,10),
(98,'2022-05-02','TuanHuy',24000000,0,24000000,11),
(99,'2022-05-03','TranLuong',24000000,0,24000000,11),
(100,'2022-05-04','KhanhTam',24000000,0,24000000,12),
(101,'2022-05-04','TuanHuy',24000000,0,24000000,13),
(102,'2022-05-05','KhanhTam',24000000,0,24000000,14),
(103,'2022-05-06','TuanHuy',24000000,0,24000000,15),
(104,'2022-05-07','TranLuong',24000000,0,24000000,16),
(105,'2022-05-08','KhanhTam',24000000,0,24000000,17),
(106,'2022-05-10','TuanHuy',24000000,0,24000000,18),

(107,'2022-05-11','KhanhTam',24000000,0,24000000,10),
(108,'2022-05-12','TuanHuy',24000000,0,24000000,11),
(109,'2022-05-13','TranLuong',24000000,0,24000000,11),
(110,'2022-05-14','KhanhTam',24000000,0,24000000,12),
(111,'2022-05-15','TuanHuy',24000000,0,24000000,13),
(112,'2022-05-16','KhanhTam',24000000,0,24000000,14),
(113,'2022-05-17','TuanHuy',24000000,0,24000000,15),
(114,'2022-05-18','TranLuong',24000000,0,24000000,16),
(115,'2022-05-19','KhanhTam',24000000,0,24000000,17),
(116,'2022-05-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 6
(117,'2022-06-01','KhanhTam',24000000,0,24000000,10),
(118,'2022-06-02','TuanHuy',24000000,0,24000000,11),
(119,'2022-06-03','TranLuong',24000000,0,24000000,11),
(120,'2022-06-04','KhanhTam',24000000,0,24000000,12),
(121,'2022-06-04','TuanHuy',24000000,0,24000000,13),
(122,'2022-06-05','KhanhTam',24000000,0,24000000,14),
(123,'2022-06-06','TuanHuy',24000000,0,24000000,15),
(124,'2022-06-07','TranLuong',24000000,0,24000000,16),
(125,'2022-06-08','KhanhTam',24000000,0,24000000,17),
(126,'2022-06-10','TuanHuy',24000000,0,24000000,18),

(127,'2022-06-11','KhanhTam',24000000,0,24000000,10),
(128,'2022-06-12','TuanHuy',24000000,0,24000000,11),
(129,'2022-06-13','TranLuong',24000000,0,24000000,11),
(130,'2022-06-14','KhanhTam',24000000,0,24000000,12),
(131,'2022-06-15','TuanHuy',24000000,0,24000000,13),
(132,'2022-06-16','KhanhTam',24000000,0,24000000,14),
(133,'2022-06-17','TuanHuy',24000000,0,24000000,15),
(134,'2022-06-18','TranLuong',24000000,0,24000000,16),
(135,'2022-06-19','KhanhTam',24000000,0,24000000,17),
(136,'2022-06-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 7
(137,'2022-07-01','KhanhTam',24000000,0,24000000,10),
(138,'2022-07-02','TuanHuy',24000000,0,24000000,11),
(139,'2022-07-03','TranLuong',24000000,0,24000000,11),
(140,'2022-07-04','KhanhTam',24000000,0,24000000,12),
(141,'2022-07-04','TuanHuy',24000000,0,24000000,13),
(142,'2022-07-05','KhanhTam',24000000,0,24000000,14),
(143,'2022-07-06','TuanHuy',24000000,0,24000000,15),
(144,'2022-07-07','TranLuong',24000000,0,24000000,16),
(145,'2022-07-08','KhanhTam',24000000,0,24000000,17),
(146,'2022-07-10','TuanHuy',24000000,0,24000000,18),

(147,'2022-07-11','KhanhTam',24000000,0,24000000,10),
(148,'2022-07-12','TuanHuy',24000000,0,24000000,11),
(149,'2022-07-13','TranLuong',24000000,0,24000000,11),
(150,'2022-07-14','KhanhTam',24000000,0,24000000,12),
(151,'2022-07-15','TuanHuy',24000000,0,24000000,13),
(152,'2022-07-16','KhanhTam',24000000,0,24000000,14),
(153,'2022-07-17','TuanHuy',24000000,0,24000000,15),
(154,'2022-07-18','TranLuong',24000000,0,24000000,16),
(155,'2022-07-19','KhanhTam',24000000,0,24000000,17),
(156,'2022-07-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 8
(157,'2022-08-01','KhanhTam',24000000,0,24000000,10),
(158,'2022-08-02','TuanHuy',24000000,0,24000000,11),
(159,'2022-08-03','TranLuong',24000000,0,24000000,11),
(160,'2022-08-04','KhanhTam',24000000,0,24000000,12),
(161,'2022-08-04','TuanHuy',24000000,0,24000000,13),
(162,'2022-08-05','KhanhTam',24000000,0,24000000,14),
(163,'2022-08-06','TuanHuy',24000000,0,24000000,15),
(164,'2022-08-07','TranLuong',24000000,0,24000000,16),
(165,'2022-08-08','KhanhTam',24000000,0,24000000,17),
(166,'2022-08-10','TuanHuy',24000000,0,24000000,18),

(167,'2022-08-11','KhanhTam',24000000,0,24000000,10),
(168,'2022-08-12','TuanHuy',24000000,0,24000000,11),
(169,'2022-08-13','TranLuong',24000000,0,24000000,11),
(170,'2022-08-14','KhanhTam',24000000,0,24000000,12),
(171,'2022-08-15','TuanHuy',24000000,0,24000000,13),
(172,'2022-08-16','KhanhTam',24000000,0,24000000,14),
(173,'2022-08-17','TuanHuy',24000000,0,24000000,15),
(174,'2022-08-18','TranLuong',24000000,0,24000000,16),
(175,'2022-08-19','KhanhTam',24000000,0,24000000,17),
(176,'2022-08-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 9
(177,'2022-09-01','KhanhTam',24000000,0,24000000,10),
(178,'2022-09-02','TuanHuy',24000000,0,24000000,11),
(179,'2022-09-03','TranLuong',24000000,0,24000000,11),
(180,'2022-09-04','KhanhTam',24000000,0,24000000,12),
(181,'2022-09-04','TuanHuy',24000000,0,24000000,13),
(182,'2022-09-05','KhanhTam',24000000,0,24000000,14),
(183,'2022-09-06','TuanHuy',24000000,0,24000000,15),
(184,'2022-09-07','TranLuong',24000000,0,24000000,16),
(185,'2022-09-08','KhanhTam',24000000,0,24000000,17),
(186,'2022-09-10','TuanHuy',24000000,0,24000000,18),

(187,'2022-09-11','KhanhTam',24000000,0,24000000,10),
(188,'2022-09-12','TuanHuy',24000000,0,24000000,11),
(189,'2022-09-13','TranLuong',24000000,0,24000000,11),
(190,'2022-09-14','KhanhTam',24000000,0,24000000,12),
(191,'2022-09-15','TuanHuy',24000000,0,24000000,13),
(192,'2022-09-16','KhanhTam',24000000,0,24000000,14),
(193,'2022-09-17','TuanHuy',24000000,0,24000000,15),
(194,'2022-09-18','TranLuong',24000000,0,24000000,16),
(195,'2022-09-19','KhanhTam',24000000,0,24000000,17),
(196,'2022-09-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 10
(197,'2022-10-01','KhanhTam',24000000,0,24000000,10),
(198,'2022-10-02','TuanHuy',24000000,0,24000000,11),
(199,'2022-10-03','TranLuong',24000000,0,24000000,11),
(200,'2022-10-04','KhanhTam',24000000,0,24000000,12),
(201,'2022-10-04','TuanHuy',24000000,0,24000000,13),
(202,'2022-10-05','KhanhTam',24000000,0,24000000,14),
(203,'2022-10-06','TuanHuy',24000000,0,24000000,15),
(204,'2022-10-07','TranLuong',24000000,0,24000000,16),
(205,'2022-10-08','KhanhTam',24000000,0,24000000,17),
(206,'2022-10-10','TuanHuy',24000000,0,24000000,18),

(207,'2022-10-11','KhanhTam',24000000,0,24000000,10),
(208,'2022-10-12','TuanHuy',24000000,0,24000000,11),
(209,'2022-10-13','TranLuong',24000000,0,24000000,11),
(210,'2022-10-14','KhanhTam',24000000,0,24000000,12),
(211,'2022-10-15','TuanHuy',24000000,0,24000000,13),
(212,'2022-10-16','KhanhTam',24000000,0,24000000,14),
(213,'2022-10-17','TuanHuy',24000000,0,24000000,15),
(214,'2022-10-18','TranLuong',24000000,0,24000000,16),
(215,'2022-10-19','KhanhTam',24000000,0,24000000,17),
(216,'2022-10-20','TuanHuy',24000000,0,24000000,18),

(217,'2022-10-01','KhanhTam',24000000,0,24000000,10),
(218,'2022-10-02','TuanHuy',24000000,0,24000000,11),
(219,'2022-10-03','TranLuong',24000000,0,24000000,11),
(220,'2022-10-04','KhanhTam',24000000,0,24000000,12),
(221,'2022-10-04','TuanHuy',24000000,0,24000000,13),
(222,'2022-10-05','KhanhTam',24000000,0,24000000,14),
(223,'2022-10-06','TuanHuy',24000000,0,24000000,15),
(224,'2022-10-07','TranLuong',24000000,0,24000000,16),
(225,'2022-10-08','KhanhTam',24000000,0,24000000,17),
(226,'2022-10-10','TuanHuy',24000000,0,24000000,18),
--THÁNG 11
(227,'2022-11-01','KhanhTam',24000000,0,24000000,10),
(228,'2022-11-02','TuanHuy',24000000,0,24000000,11),
(229,'2022-11-03','TranLuong',24000000,0,24000000,11),
(230,'2022-11-04','KhanhTam',24000000,0,24000000,12),
(231,'2022-11-04','TuanHuy',24000000,0,24000000,13),
(232,'2022-11-05','KhanhTam',24000000,0,24000000,14),
(233,'2022-11-06','TuanHuy',24000000,0,24000000,15),
(234,'2022-11-07','TranLuong',24000000,0,24000000,16),
(235,'2022-11-08','KhanhTam',24000000,0,24000000,17),
(236,'2022-11-10','TuanHuy',24000000,0,24000000,18),

(237,'2022-11-11','KhanhTam',24000000,0,24000000,10),
(238,'2022-11-12','TuanHuy',24000000,0,24000000,11),
(239,'2022-11-13','TranLuong',24000000,0,24000000,11),
(240,'2022-11-14','KhanhTam',24000000,0,24000000,12),
(241,'2022-11-15','TuanHuy',24000000,0,24000000,13),
(242,'2022-11-16','KhanhTam',24000000,0,24000000,14),
(243,'2022-11-17','TuanHuy',24000000,0,24000000,15),
(244,'2022-11-18','TranLuong',24000000,0,24000000,16),
(245,'2022-11-19','KhanhTam',24000000,0,24000000,17),
(246,'2022-11-20','TuanHuy',24000000,0,24000000,18),
--THÁNG 12
(248,'2022-12-01','KhanhTam',24000000,0,24000000,10),
(249,'2022-12-02','TuanHuy',24000000,0,24000000,11),
(250,'2022-12-03','TranLuong',24000000,0,24000000,11),
(251,'2022-12-04','KhanhTam',24000000,0,24000000,12),
(252,'2022-12-04','TuanHuy',24000000,0,24000000,13),
(253,'2022-12-05','KhanhTam',24000000,0,24000000,14),
(254,'2022-12-06','TuanHuy',24000000,0,24000000,15),
(255,'2022-12-07','TranLuong',24000000,0,24000000,16),
(256,'2022-12-08','KhanhTam',24000000,0,24000000,17),
(257,'2022-12-10','TuanHuy',24000000,0,24000000,18)


select * from PHIEUNHAP 
INSERT INTO PHIEUNHAP
VALUES
('2022-01-08',N'ThanhHieu',500586000,1),
('2022-02-08',N'TranLuong',100586000,3),
('2022-03-08',N'TranLuong',100586000,3),
('2022-04-08',N'Minhtam',200586000,2),
('2022-05-08',N'TuanHuy',100586000,5),
('2022-06-08',N'TuanHuy',200586000,5),
('2022-07-08',N'ThanhHieu',300586000,1),
('2022-08-08',N'KhanhTam',500586000,4),
('2022-09-08',N'KhanhTam',100586000,4),
('2022-10-08',N'Minhtam',100586000,2),
('2022-11-08',N'KhanhTam',122586000,4),
('2022-12-08',N'Minhtam',105586000,2)

--TÍNH TỔNG SỐ TIỀN BÁN ĐƯỢC QUA TỪNG THÁNG

create table ThongKeNAM(
		Thang int,
		DoanhThu float,
		ChiPhi float,
		LoiNhuan float,
	)

SELECT * FROM HOADON
SELECT * FROM PHIEUNHAP
 
CREATE OR ALTER PROC SMP_DOANHTHU_NAM
AS 
BEGIN
	DELETE ThongKeNAM
	DECLARE @THANG INT = 1 , @LOINHUAN FLOAT =0, 
	@doanhThu1 FLOAT = 0,  @doanhThu2 FLOAT = 0,  @doanhThu3 FLOAT= 0 , @doanhThu4 FLOAT= 0 ,  @doanhThu5 FLOAT= 0 , @doanhThu6 FLOAT= 0 ,
	@doanhThu7 FLOAT,  @doanhThu8 FLOAT, @doanhThu9 FLOAT,  @doanhThu10 FLOAT,  @doanhThu11 FLOAT ,  @doanhThu12 FLOAT,
	@CHIPHI1 FLOAT = 0 ,@CHIPHI2 FLOAT = 0,@CHIPHI3 FLOAT = 0,@CHIPHI4 FLOAT = 0,@CHIPHI5 FLOAT = 0,@CHIPHI6 FLOAT = 0,
	@CHIPHI7 FLOAT = 0,@CHIPHI8 FLOAT = 0,@CHIPHI9 FLOAT = 0,@CHIPHI10 FLOAT = 0,@CHIPHI11 FLOAT = 0,@CHIPHI12 FLOAT = 0;
	
	SET @THANG=1;
	SET @LOINHUAN=0;
	WHILE (@THANG <13)
		BEGIN 
		IF(@THANG=1)
		BEGIN
			SET @doanhThu1 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-01-01'<= NgayTao AND NgayTao < '2022-02-01')
			SET @CHIPHI1 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-01-01'<= NgayTao AND NgayTao < '2022-02-01')
			SET @LOINHUAN = @doanhThu1 - @CHIPHI1;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu1,@CHIPHI1,@LOINHUAN)
		END
		ELSE IF(@THANG=2)
		BEGIN
			SET @doanhThu2 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-02-01'<=NgayTao AND NgayTao < '2022-03-01')
			SET @CHIPHI2 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-02-01'<=NgayTao AND NgayTao < '2022-03-01')
			SET @LOINHUAN = @doanhThu2 - @CHIPHI2;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu2,@CHIPHI2,@LOINHUAN)
		END
		ELSE IF(@THANG=3)
		BEGIN
			SET @doanhThu3 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-03-01'<=NgayTao AND NgayTao < '2022-04-01')
			SET @CHIPHI3 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-03-01'<=NgayTao AND NgayTao < '2022-04-01')
			SET @LOINHUAN = @doanhThu3 - @CHIPHI3;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu3,@CHIPHI3,@LOINHUAN)
		END
		ELSE IF(@THANG=4)
		BEGIN
			SET @doanhThu4 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-04-01'<=NgayTao AND NgayTao < '2022-05-01')
			SET @CHIPHI4 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-04-01'<=NgayTao AND NgayTao < '2022-05-01')
			SET @LOINHUAN = @doanhThu4 - @CHIPHI4;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu4,@CHIPHI4,@LOINHUAN)
		END
		ELSE IF(@THANG=5)
		BEGIN
			SET @doanhThu5 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-05-01'<=NgayTao AND NgayTao < '2022-06-01')
			SET @CHIPHI5 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-05-01'<=NgayTao AND NgayTao < '2022-06-01')
			SET @LOINHUAN = @doanhThu5 - @CHIPHI5;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu5,@CHIPHI5,@LOINHUAN)
		END
		ELSE IF(@THANG=6)
		BEGIN
			SET @doanhThu6 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-06-01'<=NgayTao AND NgayTao < '2022-07-01')
			SET @CHIPHI6 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-06-01'<=NgayTao AND NgayTao < '2022-07-01')
			SET @LOINHUAN = @doanhThu6 - @CHIPHI6;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu6,@CHIPHI6,@LOINHUAN)
		END
		ELSE IF(@THANG=7)
		BEGIN
			SET @doanhThu7 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-07-01'<=NgayTao AND NgayTao < '2022-08-01')
			SET @CHIPHI7 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-07-01'<=NgayTao AND NgayTao < '2022-08-01')
			SET @LOINHUAN = @doanhThu7 - @CHIPHI7;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu7,@CHIPHI7,@LOINHUAN)
		END
		ELSE IF(@THANG=8)
		BEGIN
			SET @doanhThu8 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-08-01'<=NgayTao AND NgayTao < '2022-09-01')
			SET @CHIPHI8 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-08-01'<=NgayTao AND NgayTao < '2022-09-01')
			SET @LOINHUAN = @doanhThu8 - @CHIPHI8;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu8,@CHIPHI8,@LOINHUAN)
		END
		ELSE IF(@THANG=9)
		BEGIN
			SET @doanhThu9 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-09-01'<=NgayTao AND NgayTao < '2022-10-01')
			SET @CHIPHI9 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-09-01'<=NgayTao AND NgayTao < '2022-10-01')
			SET @LOINHUAN = @doanhThu9 - @CHIPHI9;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu9,@CHIPHI9,@LOINHUAN)
		END
		ELSE IF(@THANG=10)
		BEGIN
			SET @doanhThu10 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-10-01'<=NgayTao AND NgayTao < '2022-11-01')
			SET @CHIPHI10 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-10-01'<=NgayTao AND NgayTao < '2022-11-01')
			SET @LOINHUAN = @doanhThu10 - @CHIPHI10;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu10,@CHIPHI10,@LOINHUAN)
		END
		ELSE IF(@THANG=11)
		BEGIN
			SET @doanhThu11 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-11-01'<=NgayTao AND NgayTao < '2022-12-01')
			SET @CHIPHI11 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-11-01'<=NgayTao AND NgayTao < '2022-12-01')
			SET @LOINHUAN = @doanhThu2 - @CHIPHI11;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu11,@CHIPHI11,@LOINHUAN)
		END
		ELSE
		BEGIN
			SET @doanhThu12 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-12-01'<=NgayTao AND NgayTao < '2023-01-01')
			SET @CHIPHI12 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE   '2022-12-01'<=NgayTao AND NgayTao < '2023-01-01')
			SET @LOINHUAN = @doanhThu12 - @CHIPHI12;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu12,@CHIPHI12,@LOINHUAN)
		END
		SET @THANG = @THANG +1;
		END
		SELECT * FROM ThongKeNAM
END
GO

EXEC SMP_DOANHTHU_NAM


CREATE OR ALTER PROC SMP_DOANHTHU_QUI1
AS 
BEGIN
	DELETE ThongKeNAM
	DECLARE @THANG INT = 1 , @LOINHUAN FLOAT =0,
	@doanhThu1 FLOAT = 0,  @doanhThu2 FLOAT = 0,  @doanhThu3 FLOAT= 0 , @doanhThu4 FLOAT= 0,
	@CHIPHI1 FLOAT = 0 ,@CHIPHI2 FLOAT = 0,@CHIPHI3 FLOAT = 0,@CHIPHI4 FLOAT = 0;

	SET @THANG=1;
	SET @LOINHUAN=0;
	WHILE (@THANG < 4)
		BEGIN 
		IF(@THANG=1)
		BEGIN
			SET @doanhThu1 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-01-01' <= NgayTao AND NgayTao < '2022-02-01')
			SET @CHIPHI1 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-01-01' <= NgayTao AND NgayTao < '2022-02-01')
			SET @LOINHUAN = CONVERT(FLOAT,@doanhThu1) - CONVERT(FLOAT,@CHIPHI1);
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu1,@CHIPHI1,@LOINHUAN)
		END
		ELSE IF(@THANG=2)
		BEGIN
			SET @doanhThu2 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-02-01' <= NgayTao AND NgayTao < '2022-03-01')
			SET @CHIPHI2 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-02-01' <= NgayTao AND NgayTao < '2022-03-01')
			SET @LOINHUAN = @doanhThu2 - @CHIPHI2;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu2,@CHIPHI2,@LOINHUAN)
		END
		ELSE IF(@THANG=3)
		BEGIN
			SET @doanhThu3 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-03-01' <= NgayTao AND NgayTao < '2022-04-01')
			SET @CHIPHI3 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-03-01' <= NgayTao AND NgayTao < '2022-04-01')
			SET @LOINHUAN = @doanhThu3 - @CHIPHI3;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu3,@CHIPHI3,@LOINHUAN)
		END
		SET @THANG = @THANG +1;
		END
		SELECT * FROM ThongKeNAM
END
GO


CREATE OR ALTER PROC SMP_DOANHTHU_QUI2
AS 
BEGIN
	DELETE ThongKeNAM
	DECLARE @THANG INT = 1 , @LOINHUAN FLOAT =0,
	@doanhThu1 FLOAT = 0,  @doanhThu2 FLOAT = 0,  @doanhThu3 FLOAT= 0 , @doanhThu4 FLOAT= 0,
	@CHIPHI1 FLOAT = 0 ,@CHIPHI2 FLOAT = 0,@CHIPHI3 FLOAT = 0,@CHIPHI4 FLOAT = 0;

	SET @THANG=1;
	SET @LOINHUAN=0;
	WHILE (@THANG < 4)
		BEGIN 
		IF(@THANG=1)
		BEGIN
			SET @doanhThu1 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-04-01' <= NgayTao AND NgayTao < '2022-05-01')
			SET @CHIPHI1 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-04-01' <= NgayTao AND NgayTao < '2022-05-01')
			SET @LOINHUAN = CONVERT(FLOAT,@doanhThu1) - CONVERT(FLOAT,@CHIPHI1);
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu1,@CHIPHI1,@LOINHUAN)
		END
		ELSE IF(@THANG=2)
		BEGIN
			SET @doanhThu2 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-05-01' <= NgayTao AND NgayTao < '2022-06-01')
			SET @CHIPHI2 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-05-01' <= NgayTao AND NgayTao < '2022-06-01')
			SET @LOINHUAN = @doanhThu2 - @CHIPHI2;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu2,@CHIPHI2,@LOINHUAN)
		END
		ELSE IF(@THANG=3)
		BEGIN
			SET @doanhThu3 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-06-01' <= NgayTao AND NgayTao < '2022-07-01')
			SET @CHIPHI3 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-06-01' <= NgayTao AND NgayTao < '2022-07-01')
			SET @LOINHUAN = @doanhThu3 - @CHIPHI3;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu3,@CHIPHI3,@LOINHUAN)
		END
		SET @THANG = @THANG +1;
		END
		SELECT * FROM ThongKeNAM
END
GO


CREATE OR ALTER PROC SMP_DOANHTHU_QUI3
AS 
BEGIN
	DELETE ThongKeNAM
	DECLARE @THANG INT = 1 , @LOINHUAN FLOAT =0,
	@doanhThu1 FLOAT = 0,  @doanhThu2 FLOAT = 0,  @doanhThu3 FLOAT= 0 , @doanhThu4 FLOAT= 0,
	@CHIPHI1 FLOAT = 0 ,@CHIPHI2 FLOAT = 0,@CHIPHI3 FLOAT = 0,@CHIPHI4 FLOAT = 0;

	SET @THANG=1;
	SET @LOINHUAN=0;
	WHILE (@THANG < 4)
		BEGIN 
		IF(@THANG=1)
		BEGIN
			SET @doanhThu1 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-07-01' <= NgayTao AND NgayTao < '2022-08-01')
			SET @CHIPHI1 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-07-01' <= NgayTao AND NgayTao < '2022-08-01')
			SET @LOINHUAN = CONVERT(FLOAT,@doanhThu1) - CONVERT(FLOAT,@CHIPHI1);
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu1,@CHIPHI1,@LOINHUAN)
		END
		ELSE IF(@THANG=2)
		BEGIN
			SET @doanhThu2 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-08-01' <= NgayTao AND NgayTao < '2022-09-01')
			SET @CHIPHI2 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-08-01' <= NgayTao AND NgayTao < '2022-09-01')
			SET @LOINHUAN = @doanhThu2 - @CHIPHI2;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu2,@CHIPHI2,@LOINHUAN)
		END
		ELSE IF(@THANG=3)
		BEGIN
			SET @doanhThu3 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-09-01' <= NgayTao AND NgayTao < '2022-10-01')
			SET @CHIPHI3 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-09-01' <= NgayTao AND NgayTao < '2022-10-01')
			SET @LOINHUAN = @doanhThu3 - @CHIPHI3;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu3,@CHIPHI3,@LOINHUAN)
		END
		SET @THANG = @THANG +1;
		END
		SELECT * FROM ThongKeNAM
END
GO


CREATE OR ALTER PROC SMP_DOANHTHU_QUI4
AS 
BEGIN
	DELETE ThongKeNAM
	DECLARE @THANG INT = 1 , @LOINHUAN FLOAT =0,
	@doanhThu1 FLOAT = 0,  @doanhThu2 FLOAT = 0,  @doanhThu3 FLOAT= 0 , @doanhThu4 FLOAT= 0,
	@CHIPHI1 FLOAT = 0 ,@CHIPHI2 FLOAT = 0,@CHIPHI3 FLOAT = 0,@CHIPHI4 FLOAT = 0;

	SET @THANG=1;
	SET @LOINHUAN=0;
	WHILE (@THANG < 4)
		BEGIN 
		IF(@THANG=1)
		BEGIN
			SET @doanhThu1 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-10-01' <= NgayTao AND NgayTao < '2022-11-01')
			SET @CHIPHI1 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-10-01' <= NgayTao AND NgayTao < '2022-11-01')
			SET @LOINHUAN = CONVERT(FLOAT,@doanhThu1) - CONVERT(FLOAT,@CHIPHI1);
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu1,@CHIPHI1,@LOINHUAN)
		END
		ELSE IF(@THANG=2)
		BEGIN
			SET @doanhThu2 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-11-01' <= NgayTao AND NgayTao < '2022-12-01')
			SET @CHIPHI2 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE '2022-11-01' <= NgayTao AND NgayTao < '2022-12-01')
			SET @LOINHUAN = @doanhThu2 - @CHIPHI2;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu2,@CHIPHI2,@LOINHUAN)
		END
		ELSE IF(@THANG=3)
		BEGIN
			SET @doanhThu3 = (SELECT SUM(ThanhTien) FROM HOADON WHERE '2022-12-01' <= NgayTao AND NgayTao < '2022-12-31')
			SET @CHIPHI3 = (SELECT SUM(ThanhTien) FROM PHIEUNHAP WHERE  '2022-12-01' <= NgayTao AND NgayTao < '2022-12-31')
			SET @LOINHUAN = @doanhThu3 - @CHIPHI3;
			INSERT INTO ThongKeNAM VALUES(@THANG,@doanhThu3,@CHIPHI3,@LOINHUAN)
		END
		SET @THANG = @THANG +1;
		END
		SELECT * FROM ThongKeNAM
END
GO


EXEC SMP_DOANHTHU_QUI1

EXEC SMP_DOANHTHU_QUI2

EXEC SMP_DOANHTHU_QUI3
select * from HOADON

-- Proc HÓA ĐƠN tìm theo ngày, tháng năm
CREATE OR ALTER PROC doanhThu_Nam(@Year NVARCHAR(MAX))
AS BEGIN 
	SELECT MaHD,NgayTao,NguoiTao, TongTien
	FROM HOADON 
	WHERE NgayTao= @Year
END

-- Proc HÓA ĐƠN tìm theo  tháng
CREATE OR ALTER  PROC doanhThu_Thang(@month NVARCHAR(MAX))
AS BEGIN 
	SELECT MaHD,NgayTao,NguoiTao, TongTien
	FROM HOADON
	WHERE MONTH(NgayTao)= @month
END



EXEC doanhThu_Nam 2022
EXEC doanhThu_Thang 3

-- Proc PHIẾU NHẬP tìm theo tháng năm
SELECT * FROM PHIEUNHAP
CREATE OR ALTER PROC PhieuNhap_Nam(@year NVARCHAR(MAX))
AS
BEGIN 
	SELECT MaPN,NgayTao,NguoiTao, ThanhTien, MaAccount
	FROM PHIEUNHAP
	WHERE YEAR(NgayTao)= @year
END


CREATE OR ALTER PROC PhieuNhap_Thang(@month NVARCHAR(MAX))
AS BEGIN 
	SELECT MaPN,NgayTao,NguoiTao, ThanhTien, MaAccount
	FROM PHIEUNHAP
	WHERE MONTH(NgayTao)= @month
END

EXEC PhieuNhap_Nam 2022
EXEC PhieuNhap_Thang 3

--PRO HoaDon theo Nam 
CREATE PROC sp_HoaDonTheoNam(@year int)
AS BEGIN 
	SELECT MaHD,NgayTao,NguoiTao, TongTien, Sale, ThanhTien, MaKH
	FROM HOADON
	WHERE YEAR(NgayTao)= @year
END


--PRO HoaDon theo Thang 
CREATE PROC sp_HoaDonTheoThang(@month int)
AS BEGIN 
	SELECT MaHD,NgayTao,NguoiTao, TongTien, Sale, ThanhTien, MaKH
	FROM HOADON
	WHERE MONTH(NgayTao)= @month
END


--PRO HoaDon theo Ngay
CREATE PROC sp_HoaDonTheoNgay(@day int)
AS BEGIN 
	SELECT MaHD,NgayTao,NguoiTao, TongTien, Sale, ThanhTien, MaKH
	FROM HOADON
	WHERE DAY(NgayTao)= @day
END

EXEC sp_HoaDonTheoThang 11
